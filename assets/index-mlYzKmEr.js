(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const E=e=>{const t=document.createElement("div");t.classList="grid-container";const r=()=>{const s=document.createElement("div");s.classList="tags-x";for(let o=0;o<e;o++){const a=document.createElement("p");a.textContent=String.fromCharCode(65+o),s.appendChild(a)}return s},i=()=>{const s=document.createElement("div");s.classList="tags-y";for(let o=0;o<e;o++){const a=document.createElement("p");a.textContent=o+1,s.appendChild(a)}return s},n=()=>{const s=document.createElement("div");s.classList="grid";let o=1,a=1;for(let c=0;c<e*e;c++){const d=document.createElement("div");d.classList="grid-row",d.setAttribute("data-coordinates",`${o++},${a}`),o>10&&(o=1,a++),s.appendChild(d)}return s};return t.appendChild(r()),t.appendChild(i()),t.appendChild(n()),t},w=e=>{const t=document.querySelectorAll("#ships-grid .grid-row"),r=(s,o)=>{t.forEach(a=>{const c=a.getAttribute("data-coordinates").split(",");o[0]==c[0]&&o[1]==c[1]&&a.classList.add(s)})},i=Object.keys(e),n=Object.values(e);i.forEach((s,o)=>{n[o].forEach(a=>{a.forEach(c=>r(s,c))})})},m=()=>{const e=document.getElementById("ships-grid"),t=document.getElementById("attack-grid");t.classList.add("hidden"),e.replaceChildren(),t.replaceChildren(),e.appendChild(E(10)),t.appendChild(E(10))},A=e=>{document.getElementById("attack-grid").querySelector(`div[data-coordinates = "${e.join(",")}"]`).classList.add("attacked")},I=e=>{document.getElementById("attack-grid").querySelector(`div[data-coordinates = "${e.join(",")}"]`).classList.add("hitted")},G=e=>{const r=document.getElementById("ships-grid").querySelector(`div[data-coordinates = "${e.join(",")}"]`);r.textContent="X"},L=e=>{const t=document.getElementById("dialog-winner"),r=t.querySelector("p");r.textContent="The winner is: "+e,t.showModal()},k=()=>{const e=document.getElementById("select-ships");document.getElementById("attack-grid").classList.toggle("hidden"),e.classList.toggle("hidden")},q=e=>{const t=document.querySelectorAll("#ships-grid .grid-row"),r=e.length===4?"four":e.length===3?"three":e.length===2?"two":"one";e.forEach(i=>{t.forEach(n=>{const s=n.getAttribute("data-coordinates").split(",");s[0]==i[0]&&s[1]==i[1]&&n.classList.add(r)})})},v=()=>{const e=Math.floor(Math.random()*10)+1,t=Math.floor(Math.random()*10)+1;return[e,t]},B=()=>{const e=[];let t=1,r=4;for(;t<=4;){for(let i=0;i<t;i++)e.push(r);r--,t++}return e},M=()=>{const e=[];for(let t=1;t<=10;t++)for(let r=1;r<=10;r++)e.push([t,r]);return e},O=e=>(e.forEach((t,r)=>{e[r]=Number(t)}),e),x=(e,t)=>(e=Array.from(e),e.indexOf(t));class b{#t=0;#e=!1;constructor(t){this.length=t}hit(){this.#t++,this.#e=this.#t===this.length}isSunk(){return this.#e}}class C{#t=[];#e=[];constructor(){this.missedHits=[]}createShip(t){return{ship:new b(t),coordinates:[]}}receiveAttack(t){const[r,i]=t;let n=null;return this.#t.forEach(s=>{s.coordinates.forEach(o=>{o[0]===r&&o[1]===i&&(n=s)})}),n?n.ship.hit():this.missedHits.push(t),n?!0:null}placeShip(t,r){const i=t.ship.length,n=l=>l[0]>10||l[1]>10||l[0]<1||l[1]<1?null:!this.#e.some(u=>u[0]===l[0]&&u[1]===l[1]),s=(l,u,g)=>{const p=[];let f=[...l];for(let y=0;y<i;y++)p.push([...f]),f[g]+=u;return p};let o=Math.round(Math.random()),a=o===1?-1:1;const c=[...r];let d=null,h=null;for(let l=0;l<2;l++){for(let u=0;u<2&&(h=s(c,a,o),d=h.every(g=>n(g)),!d);u++)a=a===-1?1:-1;if(d)break;o=Math.abs(o-1)}if(d)this.#t.push(t),h.forEach(l=>{this.#e.push(l),t.coordinates.push(l)});else return null}randomFloat(){this.reset();const t=i=>this.#e.some(n=>n[0]===i[0]&&n[1]===i[1]),r=B();for(;this.#t.length<10;){let i=v(),n=t(i);for(;n;)i=v(),n=t(i);const s=this.createShip(r[this.#t.length]);this.placeShip(s,i)}}draggedShip(t){const r=new b;this.#t.push({coordinates:t,ship:r})}reset(){this.#t.length=0,this.#e.length=0,this.#e.length=0}getAllCoordinates(){return[...this.#e]}getShips(){const t=this.#t.map(r=>r.coordinates);return{four:t.filter(r=>r.length===4),three:t.filter(r=>r.length===3),two:t.filter(r=>r.length===2),one:t.filter(r=>r.length===1)}}ships(){return[...this.#t]}}class S{constructor(t="Human"){this.type=t,this.gameboard=new C}hasLost(){return this.gameboard.ships().map(r=>r.ship).every(r=>r.isSunk())}resetGame(){this.gameboard=new C}}class D{constructor(){this.player=new S("computer"),this.attacks=M()}randomAtack(){const t=Math.floor(Math.random()*this.attacks.length),r=this.attacks[t];return this.attacks.splice(t,1),r}}const F=()=>{const e=new S("human"),t=new D;return t.player.gameboard.randomFloat(),{play:o=>{o=O(o);const a=t.player.gameboard.receiveAttack(o);if(A(o),a&&I(o),t.player.hasLost()){L("You");return}const c=t.randomAtack();if(e.gameboard.receiveAttack(c),G(c),e.hasLost()){L("Computer");return}},random:()=>{m(),e.gameboard.randomFloat(),w(e.gameboard.getShips())},placeDraggedItem:(o,a,c,d)=>{const h=[];c=c.map(l=>Number(l));for(let l=0;l<o;l++)d?h.push([c[0],c[1]-a]):h.push([c[0]-a,c[1]]),a--;q(h),e.gameboard.draggedShip(h)},reseGame:()=>{e.gameboard.reset(),t.player.gameboard.reset(),t.player.gameboard.randomFloat()}}};function j(){document.querySelectorAll("#select-ships > div > div").forEach(t=>{t.classList.toggle("hidden")})}function N(){document.querySelectorAll("#select-ships > div > div").forEach(t=>{t.classList.add("hidden")})}document.addEventListener("DOMContentLoaded",()=>{m();const e=F();document.getElementById("random").addEventListener("click",()=>{e.random(),N()}),document.getElementById("select-ships").addEventListener("click",s=>{s.target.classList.contains("grid-row")&&s.target.parentElement.classList.toggle("rotate")});let t=null,r=null,i=null,n=null;document.getElementById("select-ships").addEventListener("dragstart",s=>{s.target.classList.contains("select-ship")&&(t=x(s.target.children,document.elementFromPoint(s.clientX,s.clientY)),r=s.target.classList.contains("rotate"),i=s.target.children.length,n=s.target)}),document.querySelector("#ships-grid").addEventListener("dragover",s=>{s.preventDefault()}),document.querySelector("#ships-grid").addEventListener("drop",s=>{if(s.preventDefault(),s.target.classList.contains("grid-row")){const o=s.target.getAttribute("data-coordinates").split(",");e.placeDraggedItem(i,t,o,r),n.classList.toggle("hidden")}}),document.querySelector("#play").addEventListener("click",k),document.getElementById("attack-grid").addEventListener("click",s=>{if(s.target.classList.contains("grid-row")&&!s.target.classList.contains("attacked")){const o=s.target.getAttribute("data-coordinates").split(",");e.play(o)}}),document.querySelector(".reset-button").addEventListener("click",()=>{e.reseGame(),k(),document.querySelector("dialog").close(),m(),j()})});
